# Fleet templating

Very simple helm chart renders input resources as is.

Should be used with [fleet templating](fleet.rancher.io/ref-fleet-yaml#templating) to enable templating in otherwise static manifests.

For example, if you want to make the clusterIssuer dynamic = move content out of cluster-issuer.yaml:

```yaml
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: vault.lab.gr8it.cloud
spec:
  acme:
    server: https://vault.lab.gr8it.cloud:8200/v1/pki-int-lab.gr8it.cloud/acme/directory
    privateKeySecretRef:
      name: lab-vault-acme-account-key
    caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUVTRENDQXpDZ0F3SUJBZ0lVY1I1enJlVmNsMG94S3NnL2h6NXkxNkE1RXA0d0RRWUpLb1pJaHZjTkFRRUwKQlFBd01qRUxNQWtHQTFVRUJoTUNVMHN4RGpBTUJnTlZCQW9UQldkeU9HbDBNUk13RVFZRFZRUURFd3BuY2pocApkQzF5YjI5ME1CNFhEVEl6TVRBd05qRXpNREEwT0ZvWERUSTRNVEF3TkRFek1ERXhPRm93TnpFTE1Ba0dBMVVFCkJoTUNVMHN4RGpBTUJnTlZCQW9UQldkeU9HbDBNUmd3RmdZRFZRUURFdzlzWVdJdVozSTRhWFF1WTJ4dmRXUXcKZ2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRQzdIM0pSRGU4SDZUYUJvKzFrdURkZwplOU9HdTZiVndhcE5FSklsMEFydzZiWmZyOStGcDgzS2Y4TVJWUXlQYUM4MFRRMGpqUHU0VGdrbmtHQXJhdE5nCjhPM1RSMVc3UUVEWEJhZC9URGZ5WlNISHFrVVlNRW56NzgwcHhhVXBIVDErRE00c2RmM0dvMzY3bER2RDJLVTIKUmc4RWh5Nk5CNVlsOGZsdmpCNFlodnV2WDFTNlc5T253dTFEZGxaZ2pCSnNhYUpld0JsaHJ5TVF6OWMrWDd4RApkSFE3YXB3dm8raTUvaGovMWNjRWxSbjYwN0hFVDgwdkkvUm5WYU5oeE1jSmdKVEljQUVjM0JFVWxnMysyOHErCk9aSlFoS240Z1pRWGxNOGRvdFV1ZHYvQlRXNmRKRUxPNFpocHBOTFZaWVJVMmVKWDVNZG5DdjBxYng0cWQ2ODcKQWdNQkFBR2pnZ0ZQTUlJQlN6QU9CZ05WSFE4QkFmOEVCQU1DQVFZd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZApCZ05WSFE0RUZnUVVkRlpJNElCZkRRVW8vZWVIRFdqaUpCbWdHOWt3SHdZRFZSMGpCQmd3Rm9BVXprZW9XL2M5CnFwbjVYNjFZd3hBbUc2MmljSzh3Z1p3R0NDc0dBUVVGQndFQkJJR1BNSUdNTUVVR0NDc0dBUVVGQnpBQmhqbG8KZEhSd2N6b3ZMM1poZFd4MExteGhZaTVuY2pocGRDNWpiRzkxWkRvNE1qQXdMM1l4TDNCcmFTMXliMjkwTFdkeQpPR2wwTDI5amMzQXdRd1lJS3dZQkJRVUhNQUtHTjJoMGRIQnpPaTh2ZG1GMWJIUXViR0ZpTG1keU9HbDBMbU5zCmIzVmtPamd5TURBdmRqRXZjR3RwTFhKdmIzUXRaM0k0YVhRdlkyRXdTUVlEVlIwZkJFSXdRREErb0R5Z09vWTQKYUhSMGNITTZMeTkyWVhWc2RDNXNZV0l1WjNJNGFYUXVZMnh2ZFdRNk9ESXdNQzkyTVM5d2Eya3RjbTl2ZEMxbgpjamhwZEM5amNtd3dEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBSk14emxnRVNLQ2JjNDk4QXZhRFZETk8wSDI3Cm1mK1g3NEN0YytmYUNLMC9zYnZtNkNHUDVmamtLVDhxQnRadXVtbFF5TVRJVklMbEdNWUVDa2JLWkthVDRtVjcKc0UrQkJ2Z09PVjJpMGRzNzgvSDZ1R1V6OUIwVGhReXdsZnFTTk13NjdtcjNneFVhTnU3VU1mQ0hmcG1RTnhBNgoydjhpcmFiRnVOeFVyWVdybkQ4UE8rUnAxTndyNmJGQnV2U2t1ZzZDVVJFMElwZXJGbmRDQ0d3QlNNV1BSTk15CndSMVpJc04rRnl3VHg2b051Z1dpL2RFUEduSmdCR1pnaitLWjU0Yk1Jbnh6aHFlT3pvUTkzTVNMNWJSOUUvaG8KakxwbS9WbENPWXVKbmM1M0hudlQ1RWZWek1qamllbk55dWhRSU5pVjNCOHYyUTJsWWxuanFOTUU2dGc9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    solvers:
    - http01:
        ingress:
          ingressClassName: nginx
```

to an item in values.yaml:

```yaml
items:
- apiVersion: cert-manager.io/v1
  kind: ClusterIssuer
  metadata:
    name: vault.lab.gr8it.cloud
  spec:
    acme:
      server: https://vault.lab.gr8it.cloud:8200/v1/pki-int-lab.gr8it.cloud/acme/directory
      privateKeySecretRef:
        name: lab-vault-acme-account-key
      caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUVTRENDQXpDZ0F3SUJBZ0lVY1I1enJlVmNsMG94S3NnL2h6NXkxNkE1RXA0d0RRWUpLb1pJaHZjTkFRRUwKQlFBd01qRUxNQWtHQTFVRUJoTUNVMHN4RGpBTUJnTlZCQW9UQldkeU9HbDBNUk13RVFZRFZRUURFd3BuY2pocApkQzF5YjI5ME1CNFhEVEl6TVRBd05qRXpNREEwT0ZvWERUSTRNVEF3TkRFek1ERXhPRm93TnpFTE1Ba0dBMVVFCkJoTUNVMHN4RGpBTUJnTlZCQW9UQldkeU9HbDBNUmd3RmdZRFZRUURFdzlzWVdJdVozSTRhWFF1WTJ4dmRXUXcKZ2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRQzdIM0pSRGU4SDZUYUJvKzFrdURkZwplOU9HdTZiVndhcE5FSklsMEFydzZiWmZyOStGcDgzS2Y4TVJWUXlQYUM4MFRRMGpqUHU0VGdrbmtHQXJhdE5nCjhPM1RSMVc3UUVEWEJhZC9URGZ5WlNISHFrVVlNRW56NzgwcHhhVXBIVDErRE00c2RmM0dvMzY3bER2RDJLVTIKUmc4RWh5Nk5CNVlsOGZsdmpCNFlodnV2WDFTNlc5T253dTFEZGxaZ2pCSnNhYUpld0JsaHJ5TVF6OWMrWDd4RApkSFE3YXB3dm8raTUvaGovMWNjRWxSbjYwN0hFVDgwdkkvUm5WYU5oeE1jSmdKVEljQUVjM0JFVWxnMysyOHErCk9aSlFoS240Z1pRWGxNOGRvdFV1ZHYvQlRXNmRKRUxPNFpocHBOTFZaWVJVMmVKWDVNZG5DdjBxYng0cWQ2ODcKQWdNQkFBR2pnZ0ZQTUlJQlN6QU9CZ05WSFE4QkFmOEVCQU1DQVFZd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZApCZ05WSFE0RUZnUVVkRlpJNElCZkRRVW8vZWVIRFdqaUpCbWdHOWt3SHdZRFZSMGpCQmd3Rm9BVXprZW9XL2M5CnFwbjVYNjFZd3hBbUc2MmljSzh3Z1p3R0NDc0dBUVVGQndFQkJJR1BNSUdNTUVVR0NDc0dBUVVGQnpBQmhqbG8KZEhSd2N6b3ZMM1poZFd4MExteGhZaTVuY2pocGRDNWpiRzkxWkRvNE1qQXdMM1l4TDNCcmFTMXliMjkwTFdkeQpPR2wwTDI5amMzQXdRd1lJS3dZQkJRVUhNQUtHTjJoMGRIQnpPaTh2ZG1GMWJIUXViR0ZpTG1keU9HbDBMbU5zCmIzVmtPamd5TURBdmRqRXZjR3RwTFhKdmIzUXRaM0k0YVhRdlkyRXdTUVlEVlIwZkJFSXdRREErb0R5Z09vWTQKYUhSMGNITTZMeTkyWVhWc2RDNXNZV0l1WjNJNGFYUXVZMnh2ZFdRNk9ESXdNQzkyTVM5d2Eya3RjbTl2ZEMxbgpjamhwZEM5amNtd3dEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBSk14emxnRVNLQ2JjNDk4QXZhRFZETk8wSDI3Cm1mK1g3NEN0YytmYUNLMC9zYnZtNkNHUDVmamtLVDhxQnRadXVtbFF5TVRJVklMbEdNWUVDa2JLWkthVDRtVjcKc0UrQkJ2Z09PVjJpMGRzNzgvSDZ1R1V6OUIwVGhReXdsZnFTTk13NjdtcjNneFVhTnU3VU1mQ0hmcG1RTnhBNgoydjhpcmFiRnVOeFVyWVdybkQ4UE8rUnAxTndyNmJGQnV2U2t1ZzZDVVJFMElwZXJGbmRDQ0d3QlNNV1BSTk15CndSMVpJc04rRnl3VHg2b051Z1dpL2RFUEduSmdCR1pnaitLWjU0Yk1Jbnh6aHFlT3pvUTkzTVNMNWJSOUUvaG8KakxwbS9WbENPWXVKbmM1M0hudlQ1RWZWek1qamllbk55dWhRSU5pVjNCOHYyUTJsWWxuanFOTUU2dGc9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
      solvers:
      - http01:
          ingress:
            ingressClassName: nginx
```

and now you can use fleet templating in values.yaml, e.g.:

```yaml
items:
- ...
  spec:
    acme:
      server: https://${ get .ClusterLabels "vaultURL" }/v1/pki-int-lab.gr8it.cloud/acme/directory
  ...
```

## TODO

- multiline string handling needs work -> every input (>,>-,>+,|,|-,|+) ends up the same!
  - alternativelly, if there is no solution, the resources could be provided as strings, e.g.

```yaml
items:
- content: |
    foo: bar
    
- foo: bar
```
